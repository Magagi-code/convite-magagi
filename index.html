function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("PÃ¡gina1");
  var data = JSON.parse(e.postData.contents);

  // Salvar na planilha
  sheet.appendRow([
    new Date(),
    data.nome,
    data.presenca
  ]);

  // Enviar e-mail de notificaÃ§Ã£o
  var email = "jeovanajully@gmail.com";  // seu e-mail
  var assunto = "Nova confirmaÃ§Ã£o de presenÃ§a ğŸ‰";
  var mensagem =
    "VocÃª recebeu uma nova confirmaÃ§Ã£o!\n\n" +
    "Nome: " + data.nome + "\n" +
    "PresenÃ§a: " + data.presenca + "\n\n" +
    "Planilha atualizada automaticamente. ğŸ’–";

  MailApp.sendEmail(email, assunto, mensagem);

  // Retorno
  return ContentService
    .createTextOutput(JSON.stringify({ status: "ok" }))
    .setMimeType(ContentService.MimeType.JSON);
}
